"use strict";function gulpTemplater(e){var t=new Stream.Transform({objectMode:!0});return t._transform=function(t,r,n){var a=t.contents.toString(),u=function(e){var t=function(e,t,r){return e===r.htmlPlaceholder?t.innerHTML:t.getAttribute(e)},r=function(e,r,n){return r.replace(n.bracketsRegexp,function(r,a){return t(a,e,n)})},n=function(e){return e.parseHtmlPage?window.document:e.document},a=function(e,t,n,a){return e.replace(t[0].outerHTML,r(t[0],n,a))},u=function(e,t,r,n){e.parseHtmlPage?t[0].outerHTML=a(t[0].outerHTML,t,n,e):r.rawHTML=a(r.rawHTML,t,n,e)},o=function(e,t,r){var a=n(e),c=a.getElementsByTagName(t);c.length&&(u(e,c,a,r),o(e,t,r))};return function(e){for(var t in e.tags)if(e.tags.hasOwnProperty(t))try{o(e,t,fs.readFileSync(e.tags[t],"utf8"))}catch(r){o(e,t,e.tags[t])}if(!e.parseHtmlPage){return n(e).rawHTML}}(e)};e.document=parser.parseFromString(a);var o=new Buffer(u(e),"binary").toString("base64");t.contents=new Buffer(o,"base64"),n(null,t)},t}var Stream=require("stream"),Path=require("path"),DomParser=require("dom-parser"),parser=new DomParser,fs=require("fs");module.exports=gulpTemplater;