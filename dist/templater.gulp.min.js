!function(e,t){if("function"==typeof define&&define.amd)define(["module","stream","path","dom-parser","fs"],t);else if("undefined"!=typeof exports)t(module,require("stream"),require("path"),require("dom-parser"),require("fs"));else{var r={exports:{}};t(r,e.stream,e.path,e.domParser,e.fs),e.templaterGulp=r.exports}}(this,function(e,t,r,n,a){"use strict";function u(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=new i.default.Transform({objectMode:!0});return t._transform=function(t,r,n){var a=t.contents.toString();e.document=p.parseFromString(a);var u=function(){function e(){s(this,e)}return f(e,null,[{key:"getAttributeValue",value:function(e,t,r){return e===r.htmlPlaceholder?t.innerHTML:t.getAttribute(e)}},{key:"processTemplate",value:function(e,t,r){var n=this;return t.replace(r.bracketsRegexp,function(t,a){return n.getAttributeValue(a,e,r)})}},{key:"getDOM",value:function(e){return e.parseHtmlPage?window.document:e.document}},{key:"replaceCustomTag",value:function(e,t,r,n){return e.replace(t[0].outerHTML,this.processTemplate(t[0],r,n))}},{key:"parseFromHtmlOrFile",value:function(e,t,r,n){e.parseHtmlPage?t[0].outerHTML=this.replaceCustomTag(t[0].outerHTML,t,n,e):r.rawHTML=this.replaceCustomTag(r.rawHTML,t,n,e)}},{key:"processAllCurrentTags",value:function(e,t,r){var n=this.getDOM(e),a=n.getElementsByTagName(t);a.length&&(this.parseFromHtmlOrFile(e,a,n,r),this.processAllCurrentTags(e,t,r))}},{key:"run",value:function(e){for(var t in e.tags)if(e.tags.hasOwnProperty(t))try{this.processAllCurrentTags(e,t,c.default.readFileSync(e.tags[t],"utf8"))}catch(r){this.processAllCurrentTags(e,t,e.tags[t])}if(!e.parseHtmlPage){return this.getDOM(e).rawHTML}}}]),e}(),o=new Buffer(u.run(e),"binary").toString("base64");t.contents=new Buffer(o,"base64"),n(null,t)},t}var i=u(t),l=(u(r),u(n)),c=u(a),f=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),p=new l.default;e.exports=o});